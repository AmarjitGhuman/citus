--
-- MULTI_BASIC_QUERIES
--
-- Execute simple sum, average, and count queries on data recently uploaded to
-- our partitioned table.
SELECT count(*) FROM lineitem;
WARNING:  list_length before removal: 0
WARNING:  list_length after removal: 0
 count
---------------------------------------------------------------------
 12000
(1 row)

SELECT sum(l_extendedprice) FROM lineitem;
WARNING:  list_length before removal: 0
WARNING:  list_length after removal: 0
     sum
---------------------------------------------------------------------
 457702024.50
(1 row)

SELECT avg(l_extendedprice) FROM lineitem;
WARNING:  list_length before removal: 0
WARNING:  list_length after removal: 0
        avg
---------------------------------------------------------------------
 38141.835375000000
(1 row)

-- Verify that we can do queries in read-only mode
BEGIN;
SET TRANSACTION READ ONLY;
SELECT count(*) FROM lineitem;
WARNING:  list_length before removal: 0
WARNING:  list_length after removal: 0
 count
---------------------------------------------------------------------
 12000
(1 row)

COMMIT;
-- Verify temp tables which are used for final result aggregation don't persist.
SELECT count(*) FROM pg_class WHERE relname LIKE 'pg_merge_job_%' AND relkind = 'r';
 count
---------------------------------------------------------------------
     0
(1 row)

